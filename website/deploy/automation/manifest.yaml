version: '1.0'
app: ai-governance-tool

components:
  frontend:
    type: react-app
    build:
      dockerfile: frontend/Dockerfile
      context: frontend
    deploy:
      service: cloudfront
      static_hosting: s3
      cdn_enabled: true
    monitoring:
      error_tracking: true
      performance_monitoring: true
    tests:
      unit: npm run test
      e2e: npm run test:e2e
      lighthouse: true

  backend:
    type: fastapi
    build:
      dockerfile: backend/Dockerfile
      context: backend
    deploy:
      service: ecs
      load_balancer: application
      auto_scaling: true
    monitoring:
      health_check: /health
      metrics_endpoint: /metrics
      tracing: true
    tests:
      unit: pytest
      integration: pytest tests/integration
      security: bandit -r src

  database:
    type: postgresql
    deploy:
      service: rds
      engine_version: '15.3'
      multi_az: true
    backup:
      automated: true
      retention_days: 30
    monitoring:
      enhanced_monitoring: true
      performance_insights: true

  cache:
    type: redis
    deploy:
      service: elasticache
      engine_version: '7.0'
      cluster_mode: true
    monitoring:
      cache_hits: true
      memory_usage: true

pipelines:
  validate:
    steps:
      - lint
      - test
      - security-scan
      - build
  deploy:
    steps:
      - validate
      - infrastructure
      - application
      - verify
      - post-deploy
  rollback:
    steps:
      - stop-deployment
      - restore-previous
      - verify
      - notify

notifications:
  slack:
    channel: '#deployments'
    events:
      - deployment.started
      - deployment.completed
      - deployment.failed
      - rollback.started
      - rollback.completed
  email:
    recipients:
      - devops@ai-governance.com
    events:
      - deployment.failed
      - security.alert
      - performance.degraded

monitoring:
  metrics:
    - name: http_request_duration_seconds
      type: histogram
      labels:
        - endpoint
        - method
        - status
    - name: active_users
      type: gauge
    - name: compliance_score
      type: gauge
      labels:
        - organization
        - policy

  alerts:
    - name: high_error_rate
      condition: error_rate > 5%
      duration: 5m
      severity: critical
    - name: api_latency
      condition: p95_latency > 500ms
      duration: 10m
      severity: warning
    - name: low_compliance_score
      condition: compliance_score < 0.6
      duration: 1h
      severity: warning

security:
  scans:
    - type: dependency
      tool: snyk
      frequency: daily
    - type: sast
      tool: sonarqube
      frequency: on-commit
    - type: container
      tool: trivy
      frequency: on-build
  compliance:
    - standard: iso42001
      checks: all
    - standard: owasp-top-10
      checks: all